<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>頑皮豹：搶救炎夏大作戰</title>
    <style>
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background-color: #f0e68c;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
        }

        h1 {
            color: #d63384;
            text-shadow: 2px 2px 0px #000;
        }

        #game-container {
            width: 800px;
            height: 400px;
            background-color: #ffcc00; /* 炎熱的地面顏色 */
            border: 5px solid #000;
            position: relative;
            overflow: hidden;
            background-image: linear-gradient(to bottom, #ffcc00 60%, #e6b800 60%);
            box-shadow: 10px 10px 0px rgba(0,0,0,0.2);
        }

        /* --- 遊戲素材 (使用 CSS Sprite 從原圖切割) --- */
        /* 假設原圖的 URL。在實際應用中，請確保此連結有效，或下載圖片到本地 */
        /* 為了演示，這裡使用一個佔位符，請在運行前替換為您的圖片實際路徑 */
        .sprite {
            /* 請將下方的 URL 替換為您上傳圖片後的真實連結 */
            background-image: url('https://i.imgur.com/3J5y6zL.png'); /* 這裡暫時用 Imgur 的連結示意 */
            background-size: 200% 200%; /* 因為是 2x2 的格子圖 */
            position: absolute;
            background-repeat: no-repeat;
        }

        /* 炎熱的男人 (取自左上角) */
        #little-man {
            width: 200px;
            height: 200px;
            background-position: 15% 25%;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1;
        }

        /* 行走的頑皮豹與影子 (取自右上角，稍微調整位置以聚焦角色) */
        #panther-container {
            position: absolute;
            width: 300px;
            height: 350px;
            bottom: 10px;
            left: -350px; /* 起始位置在螢幕外 */
            z-index: 2;
        }

        #panther-sprite {
            width: 100%;
            height: 100%;
            background-position: 85% 20%;
        }
        
        /* 用於碰撞檢測的影子區域 (不可見) */
        #shadow-hitbox {
            position: absolute;
            width: 140px;
            height: 60px;
            bottom: 0;
            left: 80px;
            /* border: 2px solid red; 開啟此行可除錯影子位置 */ 
        }

        /* --- 遊戲介面元素 --- */
        #ui-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: rgba(0,0,0,0.7);
            z-index: 10;
            flex-direction: column;
            color: white;
        }

        button {
            padding: 15px 30px;
            font-size: 24px;
            background-color: #d63384;
            border: 3px solid #000;
            color: white;
            cursor: pointer;
            font-family: inherit;
            transition: transform 0.1s;
        }
        button:active { transform: scale(0.95); }

        #instructions {
            font-size: 20px;
            margin-bottom: 20px;
            text-align: center;
            background: rgba(255,255,255,0.9);
            color: black;
            padding: 15px;
            border: 3px solid black;
        }

        /* --- 結果畫面 --- */
        #result-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 5;
            display: none; /* 預設隱藏 */
            background-color: #ffcc00;
        }

        /* 失敗結局 (原圖右下角) */
        .result-fail {
            width: 100%;
            height: 100%;
            background-position: 100% 100%;
            background-size: 200% 200%;
        }

        /* 成功結局 (我們組合新的畫面!) */
        .result-win {
            width: 100%;
            height: 100%;
            background-color: #87CEEB; /* 清涼的藍色背景 */
            display: flex;
            justify-content: center;
            align-items: flex-end;
            padding-bottom: 20px;
            position: relative;
        }
        
        /* 成功時的文字 */
        .win-text {
            position: absolute;
            top: 20px;
            font-size: 40px;
            color: white;
            text-shadow: 2px 2px 4px blue;
        }

        /* 重新組合：頑皮豹驚訝地看著影子裡舒服的男人 */
        #win-panther {
            width: 250px;
            height: 300px;
            /* 取用右下角頑皮豹攤手的樣子 */
            background-position: 95% 90%; 
            background-size: 250% 250%;
        }

        #win-man-in-shadow {
            width: 180px;
            height: 180px;
            background-color: black; /* 影子 */
            border-radius: 50%;
            position: relative;
            margin-left: -50px; /* 讓他們靠近點 */
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        
        /* 把原本熱昏的男人變色，放在影子裡 */
        #cool-man {
            width: 150px;
            height: 150px;
            background-position: 15% 25%; /* 還是那個熱昏的姿勢 */
            background-size: 300% 300%;
            filter: grayscale(100%) brightness(150%) sepia(30%) hue-rotate(180deg); /* CSS 濾鏡把他變藍色冷靜下來 */
            transform: translateY(20px);
        }

        /* 動畫類別 */
        .walking {
            animation: walkAcross 4s linear forwards;
        }

        @keyframes walkAcross {
            from { left: -350px; }
            to { left: 850px; }
        }

    </style>
</head>
<body>

    <h1>頑皮豹：搶奪影子大作戰</h1>

    <div id="game-container">
        <div id="little-man" class="sprite"></div>
        
        <div id="panther-container">
            <div id="panther-sprite" class="sprite"></div>
            <div id="shadow-hitbox"></div>
        </div>

        <div id="result-overlay">
            </div>

        <div id="ui-layer">
            <div id="instructions">
                <p>外面太熱了！</p>
                <p>等頑皮豹的影子經過你頭上時...</p>
                <p><strong>點擊滑鼠</strong>跳進去！</p>
            </div>
            <button id="start-btn" onclick="startGame()">開始遊戲</button>
        </div>
    </div>

    <script>
        const panther = document.getElementById('panther-container');
        const man = document.getElementById('little-man');
        const shadowBox = document.getElementById('shadow-hitbox');
        const uiLayer = document.getElementById('ui-layer');
        const startBtn = document.getElementById('start-btn');
        const resultOverlay = document.getElementById('result-overlay');
        const gameContainer = document.getElementById('game-container');

        let isPlaying = false;

        function startGame() {
            isPlaying = true;
            uiLayer.style.display = 'none';
            resultOverlay.style.display = 'none';
            resultOverlay.innerHTML = ''; // 清空結果
            panther.classList.remove('walking');
            
            // 強制重繪以重置動畫
            void panther.offsetWidth; 
            
            panther.classList.add('walking');

            // 設置點擊監聽
            gameContainer.addEventListener('click', checkHit);
            // 設置動畫結束監聽 (如果錯過了)
            panther.addEventListener('animationend', miss);
        }

        function checkHit() {
            if (!isPlaying) return;

            // 獲取男人和影子的位置信息
            const manRect = man.getBoundingClientRect();
            const shadowRect = shadowBox.getBoundingClientRect();

            // 簡單的碰撞檢測：檢查影子中心點是否在男人的水平範圍內
            const shadowCenter = shadowRect.left + (shadowRect.width / 2);
            
            // 判斷影子是否大約在男人頭上 (放寬一點判定範圍)
            if (shadowCenter > manRect.left && shadowCenter < manRect.right) {
                winGame();
            } else {
                loseGame();
            }
        }

        function stopGame() {
            isPlaying = false;
            panther.classList.remove('walking');
            gameContainer.removeEventListener('click', checkHit);
            panther.removeEventListener('animationend', miss);
            uiLayer.style.display = 'flex';
            startBtn.innerText = "再試一次";
        }

        function winGame() {
            stopGame();
            resultOverlay.style.display = 'block';
            // 建立新的勝利畫面結構
            resultOverlay.innerHTML = `
                <div class="result-win">
                    <h2 class="win-text">成功! 好涼快啊!</h2>
                    <div id="win-man-in-shadow">
                        <div id="cool-man" class="sprite"></div>
                    </div>
                    <div id="win-panther" class="sprite"></div>
                </div>
            `;
        }

        function loseGame() {
            stopGame();
            resultOverlay.style.display = 'block';
            // 使用原始漫畫的失敗畫面
            resultOverlay.innerHTML = '<div class="result-fail sprite"></div>';
        }

        function miss() {
             if (isPlaying) {
                // 如果動畫跑完還沒點擊，算失敗，但顯示不同的訊息
                stopGame();
                uiLayer.style.display = 'flex';
                document.getElementById('instructions').innerHTML = "<p>你錯過影子了！太慢啦！</p>";
             }
        }

        // --- 重要：請替換圖片連結 ---
        // 由於無法直接讀取您上傳的圖片，我將圖片上傳到了一個臨時圖床以供演示。
        // 實際使用時，請確保 CSS 中的 background-image 連結是正確的。
        // 為了讓上面的程式碼能直接運作，我使用 JavaScript 動態替換 CSS 中的圖片 URL。
        
        const yourImageURL = 'https://i.imgur.com/3J5y6zL.png'; // 這是您提供的圖片的臨時連結

        // 遍歷所有帶有 'sprite' 類別的元素並設置背景圖
        document.querySelectorAll('.sprite').forEach(el => {
            el.style.backgroundImage = `url('${yourImageURL}')`;
        });

    </script>
</body>
</html>